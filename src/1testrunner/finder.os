
Программа  = ОбъединитьПути(КаталогПрограммы(), "oscript.exe");
ЮнитТестер = ОбъединитьПути(ТекущийСценарий().Каталог, "testrunner.os");
Библиотека = ОбъединитьПути(ТекущийСценарий().Каталог, "..\src");

СодержимоеБиблиотеки = НайтиФайлы(Библиотека, ПолучитьМаскуВсеФайлы());

Для Каждого ФайлБиблиотеки Из СодержимоеБиблиотеки Цикл
	
	Если ФайлБиблиотеки.ЭтоКаталог() Тогда
		Сообщить("Вход в каталог пакета " + ФайлБиблиотеки.Имя);
		
		КаталогТестов = Новый Файл(ОбъединитьПути(ФайлБиблиотеки.ПолноеИмя, "tests"));
		Если КаталогТестов.Существует() и КаталогТестов.ЭтоКаталог() Тогда
			Сообщить("Каталог тестов найден");
			
			СтрокаЗапуска = """" + Программа + """ """ + ЮнитТестер + """ -runall """ + КаталогТестов.ПолноеИмя + """ xddReportPath .";
			Сообщить("Запускаю: " + СтрокаЗапуска);
			
			Процесс = СоздатьПроцесс(СтрокаЗапуска, КаталогТестов.ПолноеИмя, Истина);
			Процесс.Запустить();
			Пока Не Процесс.Завершен Цикл
				Сообщить(Процесс.ПотокВывода.ПрочитатьСтроку());
			КонецЦикла;
			
			Сообщить(Процесс.ПотокВывода.Прочитать());
			
			Сообщить("Тестирование закончено");
			
		КонецЕсли;
		
	КонецЕсли;
	
КонецЦикла;